<!doctype html><html lang=en-us><head><title>First Post // Cy83rTR0n's Blog</title><link rel="shortcut icon" href=/favicon.ico><meta charset=utf-8><meta name=generator content="Hugo 0.111.3"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Cy83rTR0n"><meta name=description content><link rel=stylesheet href=/blog-rev/css/main.min.3c3c186cd62e563ad6e2f00a89dbee656ab912d1d46f856b5605dd0232521e2a.css><meta name=twitter:card content="summary"><meta name=twitter:title content="First Post"><meta name=twitter:description content="we are given the following file # uncompyle6 version 3.7.4 # Python bytecode 2.7 (62211) # Decompiled from: Python 2.7.17 (default, Sep 30 2020, 13:38:04) # [GCC 7.5.0] # Embedded file name: reverseme.py # Compiled at: 2021-09-04 11:21:21 import numpy as np flag = 'TamilCTF{this_one_is_a_liability_dont_fall_for_it}' np.random.seed(369) data = np.array([ ord(c) for c in flag ]) extra = np.random.randint(1, 5, len(flag)) product = np.multiply(data, extra) temp1 = [ x for x in data ] temp2 = [ ord(x) for x in 'dondaVSclb' * 5 ] c = [ temp1[i] ^ temp2[i] for i in range(len(temp1)) ] flagdata = ('')."><meta property="og:title" content="First Post"><meta property="og:description" content="we are given the following file # uncompyle6 version 3.7.4 # Python bytecode 2.7 (62211) # Decompiled from: Python 2.7.17 (default, Sep 30 2020, 13:38:04) # [GCC 7.5.0] # Embedded file name: reverseme.py # Compiled at: 2021-09-04 11:21:21 import numpy as np flag = 'TamilCTF{this_one_is_a_liability_dont_fall_for_it}' np.random.seed(369) data = np.array([ ord(c) for c in flag ]) extra = np.random.randint(1, 5, len(flag)) product = np.multiply(data, extra) temp1 = [ x for x in data ] temp2 = [ ord(x) for x in 'dondaVSclb' * 5 ] c = [ temp1[i] ^ temp2[i] for i in range(len(temp1)) ] flagdata = ('')."><meta property="og:type" content="article"><meta property="og:url" content="https://Cy83rTR0n.github.io/blog-rev/posts/first-post/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-03-08T11:10:20+00:00"><meta property="article:modified_time" content="2023-03-08T11:10:20+00:00"></head><body><header class=app-header><a href=https://Cy83rTR0n.github.io/blog-rev/><img class=app-header-avatar src=/blog-rev/avatar.jpg alt=Cy83rTR0n></a>
<span class=app-header-title>Cy83rTR0n's Blog</span><p>A blog about all things technical.</p><div class=app-header-social><a href=https://github.com/Cy83rTR0n target=_blank rel="noreferrer noopener me"><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github"><title>GitHub</title><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a><a href=https://twitter.com/_Cy83rTR0n target=_blank rel="noreferrer noopener me"><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-twitter"><title>Twitter</title><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></a></div></header><main class=app-container><article class=post><header class=post-header><h1 class=post-title>First Post</h1><div class=post-meta><div><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar"><title>calendar</title><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>Mar 8, 2023</div><div><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock"><title>clock</title><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>2 min read</div></div></header><div class=post-content><h2 id=we-are-given-the-following-file>we are given the following file</h2><pre tabindex=0><code># uncompyle6 version 3.7.4
# Python bytecode 2.7 (62211)
# Decompiled from: Python 2.7.17 (default, Sep 30 2020, 13:38:04) 
# [GCC 7.5.0]
# Embedded file name: reverseme.py
# Compiled at: 2021-09-04 11:21:21
import numpy as np
flag = &#39;TamilCTF{this_one_is_a_liability_dont_fall_for_it}&#39;
np.random.seed(369)
data = np.array([ ord(c) for c in flag ])
extra = np.random.randint(1, 5, len(flag))
product = np.multiply(data, extra)
temp1 = [ x for x in data ]
temp2 = [ ord(x) for x in &#39;dondaVSclb&#39; * 5 ]
c = [ temp1[i] ^ temp2[i] for i in range(len(temp1)) ]
flagdata = (&#39;&#39;).join(hex(x)[2:].zfill(2) for x in c)
real_flag = &#39;300e030d0d1507251700361a3a0127662120093d551c311029330c53022e1d3028541315363c5e3d063d0b250a090c52021f&#39;
</code></pre><h2 id=we-are-trying-to-analyze-the-python-file-by-going-through-the-same-steps>we are trying to analyze the python file by going through the same steps.</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span><span style=color:#f92672>import</span> numpy <span style=color:#66d9ef>as</span> np
</span></span><span style=display:flex><span>flag <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;TamilCTF</span><span style=color:#e6db74>{this_one_is_a_liability_dont_fall_for_it}</span><span style=color:#e6db74>&#39;</span>
</span></span></code></pre></div><ul><li><p>The above is actually a fake flag</p></li><li><p>But we will use it for analysis purpose.</p></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>np<span style=color:#f92672>.</span>random<span style=color:#f92672>.</span>seed(<span style=color:#ae81ff>369</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>data <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>array([ord(c) <span style=color:#66d9ef>for</span> c <span style=color:#f92672>in</span> flag ])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#39;data :&#39;</span>,data)
</span></span></code></pre></div><ul><li>random function which is used as the seed here is not actually random, if we every time repeat lines 8 and 9 we will get the same data array.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>extra <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>random<span style=color:#f92672>.</span>randint(<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>5</span>,len(flag))
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#39;extra :&#39;</span>,extra)
</span></span></code></pre></div><ul><li>similarly the above also we will get everytime the same array if we follow lines 8,9,17.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>product <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>multiply(data,extra)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#39;product :&#39;</span>,product) 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>temp1 <span style=color:#f92672>=</span> [x <span style=color:#66d9ef>for</span> x <span style=color:#f92672>in</span> data ]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#39;temp1:&#39;</span>,temp1)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>temp2 <span style=color:#f92672>=</span> [ord(x) <span style=color:#66d9ef>for</span> x <span style=color:#f92672>in</span> <span style=color:#e6db74>&#39;dondaVSclb&#39;</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>5</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#39;temp2&#39;</span>,temp2)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>c <span style=color:#f92672>=</span> [ temp1[i] <span style=color:#f92672>^</span> temp2[i] <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(len(temp1)) ]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#39;c:&#39;</span>,c)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>flagdata <span style=color:#f92672>=</span> (<span style=color:#e6db74>&#39;&#39;</span>)<span style=color:#f92672>.</span>join(hex(x)[<span style=color:#ae81ff>2</span>:]<span style=color:#f92672>.</span>zfill(<span style=color:#ae81ff>2</span>) <span style=color:#66d9ef>for</span> x <span style=color:#f92672>in</span> c)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#39;flagdata :&#39;</span>,flag)
</span></span></code></pre></div><ul><li><p>here in the lines 39 and 40 we see that first the items in c are converted to hex that is 48 to 0x30 and then we neglect &lsquo;0x&rsquo; and then they are joined together.</p></li><li><p>now upto this part whatever we did was actually for analysing the code.</p></li><li><p>exploit starts from here</p></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>
</span></span><span style=display:flex><span>real_flag <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;300e030d0d1507251700361a3a0127662120093d551c311029330c53022e1d3028541315363c5e3d063d0b250a090c52021f&#39;</span>
</span></span></code></pre></div><ul><li><p>above given is the final result of the actual flag.</p></li><li><p>let&rsquo;s reverse it</p></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>real <span style=color:#f92672>=</span> list()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>100</span>,<span style=color:#ae81ff>2</span>):
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  real<span style=color:#f92672>.</span>append(real_flag[i:i<span style=color:#f92672>+</span><span style=color:#ae81ff>2</span>]) 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#39;real:&#39;</span>,real)
</span></span></code></pre></div><ul><li>We get the required array with elements but now we need to get the decimal output for our hex numbers.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>real_2 <span style=color:#f92672>=</span> list()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> real:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  real_2<span style=color:#f92672>.</span>append(int(i,<span style=color:#ae81ff>16</span>)) 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#39;real_2&#39;</span>,real_2)
</span></span></code></pre></div><ul><li>our temp2 array remains the same</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>print(<span style=color:#e6db74>&#39;temp2 :&#39;</span>,temp2)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>temp3 <span style=color:#f92672>=</span> list()
</span></span><span style=display:flex><span>temp3 <span style=color:#f92672>=</span> [temp2[i] <span style=color:#f92672>^</span> real_2[i] <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(len(temp2))]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>temp4 <span style=color:#f92672>=</span> list()
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> temp3:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  temp4<span style=color:#f92672>.</span>append(chr(i))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#39;&#39;</span><span style=color:#f92672>.</span>join(temp4))
</span></span></code></pre></div><h1 id=flag>Flag</h1><p><code>TamilCTF{bRuTeF0rCe_1s_tHe_0nLy_F0rCe_2_bReAk__1n}</code></p></div><div class=post-footer></div></article></main></body></html>