<!doctype html><html lang=en-us><head><title>Buffer Overflow // Cy83rTR0n's Blog</title><link rel="shortcut icon" href=/favicon.ico><meta charset=utf-8><meta name=generator content="Hugo 0.111.3"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Cy83rTR0n"><meta name=description content><link rel=stylesheet href=/blog-rev/css/main.min.3c3c186cd62e563ad6e2f00a89dbee656ab912d1d46f856b5605dd0232521e2a.css><meta name=twitter:card content="summary"><meta name=twitter:title content="Buffer Overflow"><meta name=twitter:description content="Stack Overflows: Overwriting Return Addresses Introduction Stack overflows are a common vulnerability that allows attackers to overwrite key data structures, such as return addresses or function pointers, with malicious data. In particular, overwriting return addresses can be a powerful technique for attackers to gain control of a program&rsquo;s execution flow and execute arbitrary code. In this blog post, we will explore the concept of stack overflows and how they can be used to overwrite return addresses in a greater detail."><meta property="og:title" content="Buffer Overflow"><meta property="og:description" content="Stack Overflows: Overwriting Return Addresses Introduction Stack overflows are a common vulnerability that allows attackers to overwrite key data structures, such as return addresses or function pointers, with malicious data. In particular, overwriting return addresses can be a powerful technique for attackers to gain control of a program&rsquo;s execution flow and execute arbitrary code. In this blog post, we will explore the concept of stack overflows and how they can be used to overwrite return addresses in a greater detail."><meta property="og:type" content="article"><meta property="og:url" content="https://Cy83rTR0n.github.io/blog-rev/posts/buffer-overflow/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-03-12T13:55:29+00:00"><meta property="article:modified_time" content="2023-03-12T13:55:29+00:00"></head><body><header class=app-header><a href=https://Cy83rTR0n.github.io/blog-rev/><img class=app-header-avatar src=/blog-rev/avatar.jpg alt=Cy83rTR0n></a>
<span class=app-header-title>Cy83rTR0n's Blog</span><p>A blog about all things technical.</p><div class=app-header-social><a href=https://github.com/Cy83rTR0n target=_blank rel="noreferrer noopener me"><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github"><title>GitHub</title><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a><a href=https://twitter.com/_Cy83rTR0n target=_blank rel="noreferrer noopener me"><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-twitter"><title>Twitter</title><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></a></div></header><main class=app-container><article class=post><header class=post-header><h1 class=post-title>Buffer Overflow</h1><div class=post-meta><div><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar"><title>calendar</title><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>Mar 12, 2023</div><div><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock"><title>clock</title><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>4 min read</div></div></header><div class=post-content><h1 id=stack-overflows-overwriting-return-addresses>Stack Overflows: Overwriting Return Addresses</h1><h2 id=introduction>Introduction</h2><p>Stack overflows are a common vulnerability that allows attackers to overwrite key data structures, such as return addresses or function pointers, with malicious data. In particular, overwriting return addresses can be a powerful technique for attackers to gain control of a program&rsquo;s execution flow and execute arbitrary code. In this blog post, we will explore the concept of stack overflows and how they can be used to overwrite return addresses in a greater detail.</p><h2 id=anatomy-of-a-stack-overflow>Anatomy of a Stack Overflow</h2><p>A stack overflow occurs when a program writes more data to a buffer than it can hold. The buffer is typically located on the stack, which is a region of memory used to store local variables and function call frames. When a function is called, its arguments and local variables are pushed onto the stack, and a return address is also pushed onto the stack. The return address is the address of the instruction to be executed after the function returns.</p><p>If an attacker can overwrite the return address with a value of their choice, they can redirect the program&rsquo;s execution flow to any address they wish, including code they have injected into memory. Overwriting the return address is typically achieved by overflowing a buffer on the stack with user-controlled data.</p><h2 id=techniques-for-overwriting-return-addresses>Techniques for Overwriting Return Addresses</h2><p>There are several techniques that attackers can use to overwrite return addresses, including:</p><ul><li><strong>Stack-Based Buffer Overflows</strong>: This is the most common technique, where an attacker overflows a buffer on the stack to overwrite the return address.</li><li><strong>Heap-Based Buffer Overflows</strong>: This technique involves overflowing a buffer allocated on the heap, rather than the stack. Heap-based buffer overflows can be more complex to exploit, but they can also be more powerful.</li><li><strong>Format String Vulnerabilities</strong>: Format string vulnerabilities occur when an attacker can control the format string argument in a function that uses the printf family of functions. By crafting a malicious format string, an attacker can overwrite arbitrary memory locations, including the return address.</li></ul><h2 id=in-depth-write-ups-on-stack-overflows>In-Depth Write-Ups on Stack Overflows</h2><p>If you&rsquo;re interested in learning more about stack overflows and how they can be exploited to overwrite return addresses, here are some great resources to check out:</p><ul><li><a href=https://www.corelan.be/index.php/2009/07/19/exploit-writing-tutorial-part-1-stack-based-overflows/>Exploit Writing Tutorials - Stack-Based Buffer Overflow</a></li><li><a href=https://sploitfun.wordpress.com/2015/06/26/basic-stack-buffer-overflow-tutorial/>Stack Buffer Overflows for Humans</a></li><li><a href=https://github.com/guyinatuxedo/ctf/tree/master/binary%20exploitation/stack%20overflows>Binary Exploitation - Stack Overflows</a></li></ul><p>These resources provide in-depth write-ups and tutorials on exploiting stack overflows, including practical examples and step-by-step guides.</p><h2 id=conclusion>Conclusion</h2><p>Stack overflows can be a powerful technique for attackers to gain control of a program&rsquo;s execution flow. Overwriting return addresses is a common technique used in stack overflow attacks. By understanding the techniques used by attackers, developers can take steps to prevent stack overflow vulnerabilities in their code. For more information on stack overflows and how to prevent them, check out the links below:</p><ul><li><a href=https://owasp.org/www-community/attacks/Stack_Overflow>OWASP - Stack Overflow</a></li><li><a href=https://www.exploit-db.com/docs/english/28553-stack-based-buffer-overflow-basics.pdf>The Exploit Database - Stack-Based Buffer Overflow Basics</a></li><li><a href=https://www.hackingarticles.in/heap-based-buffer-overflow/>Hacking Articles - Heap-Based Buffer Overflow</a></li><li><a href=https://www.exploit-db.com/docs/english/28476-format-string-vulnerability.pdf>The Exploit Database - Format String Vulnerabilities</a></li></ul><h2 id=preventing-stack-overflows>Preventing Stack Overflows</h2><p>Preventing stack overflows requires a combination of secure coding practices and defensive programming techniques. Here are some tips for preventing stack overflows in your code:</p><ul><li><strong>Validate Input</strong>: Always validate input from untrusted sources to ensure that it is within expected bounds. Use input validation techniques such as range checking, input filtering, and input sanitization to prevent buffer overflows caused by malicious input.</li><li><strong>Bounds Checking</strong>: Check that indexes and pointers are within the bounds of the data structure they are accessing. Bounds checking can help prevent buffer overflows by ensuring that the program does not write beyond the end of a buffer.</li><li><strong>Use Safe String Functions</strong>: Use safe string functions such as strncpy() and strlcpy() instead of strcpy() and strcat(). Safe string functions take a buffer size argument and prevent buffer overflows by ensuring that the program does not write beyond the end of a buffer.</li><li><strong>Disable Unsafe Functions</strong>: Disable unsafe functions such as gets() and scanf() that do not perform bounds checking and are vulnerable to buffer overflows.</li><li><strong>Use Canaries</strong>: A canary is a random value placed on the stack between the buffer and the return address. If the canary is overwritten, the program will detect the stack overflow and terminate. Canaries can help prevent stack overflows by making it more difficult for attackers to overwrite the return address.</li><li><strong>Address Space Layout Randomization (ASLR)</strong>: ASLR is a security technique that randomizes the memory addresses of key data structures, including the stack. ASLR can help prevent stack overflows by making it more difficult for attackers to predict the location of the return address.</li></ul><h2 id=conclusion-1>Conclusion</h2><p>Stack overflows are a serious vulnerability that can allow attackers to gain control of a program&rsquo;s execution flow. Overwriting return addresses is a common technique used in stack overflow attacks. By understanding the techniques used by attackers, developers can take steps to prevent stack overflow vulnerabilities in their code. Use the tips and techniques discussed in this post to help prevent stack overflows in your code.</p></div><div class=post-footer></div></article></main></body></html>